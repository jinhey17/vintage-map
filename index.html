<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¹ˆí‹°ì§€ ë³´ë¬¼ì§€ë„</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ddb2d2fdd091b40e8df161e74dbc3aeb"></script>
  <style>
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    .bottom-sheet {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-radius: 20px 20px 0 0;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
      transition: transform 0.3s ease-out;
      z-index: 100;
    }
    .bottom-sheet.closed { transform: translateY(calc(100% - 80px)); }
    .bottom-sheet.open { transform: translateY(30%); }
    .handle {
      width: 40px;
      height: 4px;
      background: #d1d5db;
      border-radius: 2px;
      margin: 12px auto;
    }
    .map-container {
      position: relative;
      overflow: hidden;
      transition: height 0.3s ease-out;
    }
    .filter-chip {
      display: inline-flex;
      align-items: center;
      padding: 8px 16px;
      border-radius: 20px;
      border: 2px solid #e5e7eb;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
      margin: 4px;
    }
    .filter-chip.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 16px;
      margin: 12px 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }
    .card:active { transform: scale(0.98); }
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: flex-end;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      width: 100%;
      border-radius: 20px 20px 0 0;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease-out;
    }
    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    .detail-page {
      position: fixed;
      inset: 0;
      background: white;
      z-index: 2000;
      overflow-y: auto;
      animation: slideInRight 0.3s ease-out;
    }
    @keyframes slideInRight {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }
    .photo-slider {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      scrollbar-width: none;
    }
    .photo-slider::-webkit-scrollbar { display: none; }
    .photo-slide {
      flex: 0 0 100%;
      scroll-snap-align: start;
      height: 250px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 64px;
    }
    .info-popup {
      position: absolute;
      background: white;
      padding: 12px 16px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      min-width: 180px;
      z-index: 50;
      animation: popIn 0.2s ease-out;
    }
    @keyframes popIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const sampleStores = [
      {
        id: 1,
        name: 'ë ˆíŠ¸ë¡œí•˜ìš°ìŠ¤',
        address: 'ì„œìš¸ ë§ˆí¬êµ¬ ì›”ë“œì»µë¡œ 123',
        lat: 37.5565,
        lng: 126.9224,
        phone: '02-1234-5678',
        hours: '12:00 - 21:00 (ì›”ìš”ì¼ íœ´ë¬´)',
        photos: ['ğŸª', 'ğŸ‘•', 'ğŸ‘—'],
        storeTypes: ['luxury', 'select'],
        disposal: ['buyback', 'donation_receipt'],
        styles: ['americana', 'classic'],
        gender: 'unisex',
        amenities: { fitting: true, restroom: true, parking: false },
        rating: 4.5,
        reviewCount: 23,
        distance: 'ë„ë³´ 5ë¶„'
      },
      {
        id: 2,
        name: 'ë¹ˆí‹°ì§€ì•¤ëª¨ì–´',
        address: 'ì„œìš¸ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 456',
        lat: 37.5000,
        lng: 127.0280,
        phone: '02-2345-6789',
        hours: '11:00 - 20:00 (ì—°ì¤‘ë¬´íœ´)',
        photos: ['ğŸ¬', 'ğŸ‘š', 'ğŸ§¥'],
        storeTypes: ['kilo'],
        disposal: ['donation_receipt'],
        styles: ['street', 'japanese'],
        gender: 'female',
        amenities: { fitting: true, restroom: false, parking: true },
        rating: 4.2,
        reviewCount: 45,
        distance: 'ë„ë³´ 12ë¶„'
      },
      {
        id: 3,
        name: 'ì˜¬ë“œìŠ¤ì¿¨ë¹ˆí‹°ì§€',
        address: 'ì„œìš¸ ë§ˆí¬êµ¬ ì™€ìš°ì‚°ë¡œ 94',
        lat: 37.5536,
        lng: 126.9234,
        phone: '02-3456-7890',
        hours: '13:00 - 22:00',
        photos: ['ğŸª', 'ğŸ‘–', 'ğŸ§¢'],
        storeTypes: ['select'],
        disposal: ['buyback'],
        styles: ['americana', 'street'],
        gender: 'male',
        amenities: { fitting: true, restroom: true, parking: false },
        rating: 4.7,
        reviewCount: 67,
        distance: 'ë„ë³´ 3ë¶„'
      },
      {
        id: 4,
        name: 'ì•„ë¦„ë‹¤ìš´ê°€ê²Œ ê°•ë‚¨ì ',
        address: 'ì„œìš¸ ê°•ë‚¨êµ¬ ê°•ë‚¨ëŒ€ë¡œ 789',
        lat: 37.5172,
        lng: 127.0473,
        phone: '02-4567-8901',
        hours: '10:00 - 19:00',
        photos: ['ğŸ€', 'ğŸ‘”', 'ğŸ’'],
        storeTypes: ['social'],
        disposal: ['donation_receipt', 'donation'],
        styles: ['classic'],
        gender: 'unisex',
        amenities: { fitting: false, restroom: true, parking: true },
        rating: 4.3,
        reviewCount: 89,
        distance: 'ë„ë³´ 8ë¶„'
      },
      {
        id: 5,
        name: 'ë³´ë¬¼ì°½ê³ ',
        address: 'ì„œìš¸ ìš©ì‚°êµ¬ ì´íƒœì›ë¡œ 234',
        lat: 37.5345,
        lng: 126.9944,
        phone: '02-5678-9012',
        hours: '12:00 - 21:00 (í™”ìš”ì¼ íœ´ë¬´)',
        photos: ['ğŸ', 'ğŸ‘—', 'ğŸ‘ '],
        storeTypes: ['kilo'],
        disposal: ['buyback'],
        styles: ['japanese', 'street'],
        gender: 'female',
        amenities: { fitting: true, restroom: false, parking: false },
        rating: 4.6,
        reviewCount: 34,
        distance: 'ë„ë³´ 15ë¶„'
      }
    ];

    const storeTypeLabels = {
      luxury: { emoji: 'ğŸ’', label: 'ëª…í’ˆ/í•˜ì´ì—”ë“œ' },
      select: { emoji: 'ğŸ§¢', label: 'ì…€ë ‰íŠ¸ìƒµ' },
      kilo: { emoji: 'âš–ï¸', label: 'í‚¬ë¡œ/ì°½ê³ í˜•' },
      social: { emoji: 'ğŸ€', label: 'ì‚¬íšŒì ê¸°ì—…' }
    };

    const disposalLabels = {
      donation_receipt: { emoji: 'ğŸ§¾', label: 'ê¸°ë¶€(ì˜ìˆ˜ì¦O)' },
      donation: { emoji: 'ğŸ', label: 'ê¸°ë¶€(ì˜ìˆ˜ì¦X)' },
      buyback: { emoji: 'ğŸ’°', label: 'ë§¤ì…ê°€ëŠ¥' }
    };

    const styleLabels = {
      americana: { emoji: 'ğŸ‡ºğŸ‡¸', label: 'ì•„ë©”ì¹´ì§€' },
      japanese: { emoji: 'ğŸ‘—', label: 'ì¼ë³¸/í˜ë¯¸ë‹Œ' },
      street: { emoji: 'ğŸ›¹', label: 'ìŠ¤íŠ¸ë¦¿/Y2K' },
      classic: { emoji: 'ğŸ‘”', label: 'í´ë˜ì‹' }
    };

    // ì¹´ì¹´ì˜¤ë§µ ì»´í¬ë„ŒíŠ¸
    function KakaoMap({ stores, onMarkerClick, height }) {
      const mapRef = useRef(null);
      const mapInstanceRef = useRef(null);
      const markersRef = useRef([]);
      const overlaysRef = useRef([]);

      useEffect(() => {
        if (!window.kakao || !window.kakao.maps || !mapRef.current) return;

        // ì§€ë„ ìƒì„±
        const options = {
          center: new window.kakao.maps.LatLng(37.5400, 126.9700),
          level: 8
        };
        const map = new window.kakao.maps.Map(mapRef.current, options);
        mapInstanceRef.current = map;

        // ì¤Œ ì»¨íŠ¸ë¡¤ ì¶”ê°€
        const zoomControl = new window.kakao.maps.ZoomControl();
        map.addControl(zoomControl, window.kakao.maps.ControlPosition.RIGHT);

        return () => {
          markersRef.current.forEach(marker => marker.setMap(null));
          overlaysRef.current.forEach(overlay => overlay.setMap(null));
        };
      }, []);

      useEffect(() => {
        if (!mapInstanceRef.current) return;

        // ê¸°ì¡´ ë§ˆì»¤, ì˜¤ë²„ë ˆì´ ì œê±°
        markersRef.current.forEach(marker => marker.setMap(null));
        overlaysRef.current.forEach(overlay => overlay.setMap(null));
        markersRef.current = [];
        overlaysRef.current = [];

        // ìƒˆ ë§ˆì»¤ ìƒì„±
        stores.forEach(store => {
          const position = new window.kakao.maps.LatLng(store.lat, store.lng);
          
          const marker = new window.kakao.maps.Marker({
            position: position,
            map: mapInstanceRef.current
          });

          // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ ë‚´ìš©
          const content = document.createElement('div');
          content.innerHTML = `
            <div style="
              background: white;
              padding: 12px 16px;
              border-radius: 12px;
              box-shadow: 0 4px 12px rgba(0,0,0,0.2);
              min-width: 180px;
            ">
              <div style="font-weight: bold; margin-bottom: 4px;">${store.name}</div>
              <div style="font-size: 12px; color: #666; margin-bottom: 8px;">${store.address}</div>
              <button id="detail-btn-${store.id}" style="
                background: #3b82f6;
                color: white;
                padding: 6px 12px;
                border-radius: 6px;
                border: none;
                cursor: pointer;
                width: 100%;
                font-weight: 500;
              ">ìƒì„¸ë³´ê¸°</button>
            </div>
          `;

          const overlay = new window.kakao.maps.CustomOverlay({
            content: content,
            position: position,
            yAnchor: 1.3
          });

          // ë§ˆì»¤ í´ë¦­ ì‹œ ì˜¤ë²„ë ˆì´ í† ê¸€
          window.kakao.maps.event.addListener(marker, 'click', function() {
            // ë‹¤ë¥¸ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
            overlaysRef.current.forEach(ov => ov.setMap(null));
            overlay.setMap(mapInstanceRef.current);
            
            // ìƒì„¸ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
            setTimeout(() => {
              const btn = document.getElementById(`detail-btn-${store.id}`);
              if (btn) {
                btn.onclick = () => {
                  overlay.setMap(null);
                  onMarkerClick(store);
                };
              }
            }, 100);
          });

          // ì§€ë„ í´ë¦­ ì‹œ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
          window.kakao.maps.event.addListener(mapInstanceRef.current, 'click', function() {
            overlay.setMap(null);
          });

          markersRef.current.push(marker);
          overlaysRef.current.push(overlay);
        });

      }, [stores, onMarkerClick]);

      return <div ref={mapRef} style={{ width: '100%', height: height }} />;
    }

    function FilterModal({ isOpen, onClose, filters, setFilters }) {
      if (!isOpen) return null;

      const toggleFilter = (category, value) => {
        setFilters(prev => {
          const current = prev[category] || [];
          if (current.includes(value)) {
            return { ...prev, [category]: current.filter(v => v !== value) };
          } else {
            return { ...prev, [category]: [...current, value] };
          }
        });
      };

      const activeCount = Object.values(filters).flat().length;

      return (
        <div className="modal" onClick={onClose}>
          <div className="modal-content" onClick={e => e.stopPropagation()}>
            <div className="sticky top-0 bg-white border-b p-4 flex justify-between items-center">
              <button onClick={onClose} className="text-2xl">â†</button>
              <h2 className="text-lg font-bold">í•„í„°</h2>
              <button onClick={() => setFilters({})} className="text-blue-500">ì´ˆê¸°í™”</button>
            </div>

            <div className="p-4">
              <h3 className="font-bold mb-3">ğŸ›ï¸ ë§¤ì¥ ì„±ê²©</h3>
              <div className="flex flex-wrap mb-6">
                {Object.entries(storeTypeLabels).map(([key, { emoji, label }]) => (
                  <div
                    key={key}
                    className={`filter-chip ${filters.storeTypes?.includes(key) ? 'active' : ''}`}
                    onClick={() => toggleFilter('storeTypes', key)}
                  >
                    <span className="mr-2">{emoji}</span>
                    {label}
                  </div>
                ))}
              </div>

              <h3 className="font-bold mb-3">â™»ï¸ ì˜· ì²˜ë¶„ ê°€ëŠ¥í•œ ê³³</h3>
              <div className="flex flex-wrap mb-6">
                {Object.entries(disposalLabels).map(([key, { emoji, label }]) => (
                  <div
                    key={key}
                    className={`filter-chip ${filters.disposal?.includes(key) ? 'active' : ''}`}
                    onClick={() => toggleFilter('disposal', key)}
                  >
                    <span className="mr-2">{emoji}</span>
                    {label}
                  </div>
                ))}
              </div>

              <h3 className="font-bold mb-3">ğŸ’¡ ìŠ¤íƒ€ì¼</h3>
              <div className="flex flex-wrap mb-6">
                {Object.entries(styleLabels).map(([key, { emoji, label }]) => (
                  <div
                    key={key}
                    className={`filter-chip ${filters.styles?.includes(key) ? 'active' : ''}`}
                    onClick={() => toggleFilter('styles', key)}
                  >
                    <span className="mr-2">{emoji}</span>
                    {label}
                  </div>
                ))}
              </div>

              <h3 className="font-bold mb-3">ğŸ‘¥ ì„±ë³„</h3>
              <div className="flex flex-wrap mb-6">
                {[
                  { value: 'female', label: 'ì—¬ì„±ì „ìš©' },
                  { value: 'male', label: 'ë‚¨ì„±ì „ìš©' },
                  { value: 'unisex', label: 'ë‚¨ë…€ê³µìš©' }
                ].map(({ value, label }) => (
                  <div
                    key={value}
                    className={`filter-chip ${filters.gender?.includes(value) ? 'active' : ''}`}
                    onClick={() => toggleFilter('gender', value)}
                  >
                    {label}
                  </div>
                ))}
              </div>

              <h3 className="font-bold mb-3">ğŸ¢ í¸ì˜ì‹œì„¤</h3>
              <div className="flex flex-wrap mb-6">
                {[
                  { value: 'fitting', label: 'í”¼íŒ…ë£¸' },
                  { value: 'restroom', label: 'í™”ì¥ì‹¤' },
                  { value: 'parking', label: 'ì£¼ì°¨ê°€ëŠ¥' }
                ].map(({ value, label }) => (
                  <div
                    key={value}
                    className={`filter-chip ${filters.amenities?.includes(value) ? 'active' : ''}`}
                    onClick={() => toggleFilter('amenities', value)}
                  >
                    {label}
                  </div>
                ))}
              </div>
            </div>

            <div className="sticky bottom-0 bg-white border-t p-4">
              <button
                onClick={onClose}
                className="w-full bg-blue-500 text-white py-3 rounded-lg font-bold"
              >
                ì ìš©í•˜ê¸° {activeCount > 0 && `(${activeCount})`}
              </button>
            </div>
          </div>
        </div>
      );
    }

    function DetailPage({ store, onClose }) {
      if (!store) return null;
      const detailMapRef = useRef(null);

      useEffect(() => {
        if (!window.kakao || !window.kakao.maps || !detailMapRef.current) return;
        
        const position = new window.kakao.maps.LatLng(store.lat, store.lng);
        const options = {
          center: position,
          level: 3
        };
        const map = new window.kakao.maps.Map(detailMapRef.current, options);
        
        new window.kakao.maps.Marker({
          position: position,
          map: map
        });
      }, [store]);

      return (
        <div className="detail-page">
          <div className="sticky top-0 bg-white border-b p-4 flex items-center z-10">
            <button onClick={onClose} className="text-2xl mr-4">â†</button>
            <h1 className="text-lg font-bold">{store.name}</h1>
          </div>

          <div className="photo-slider">
            {store.photos.map((photo, i) => (
              <div key={i} className="photo-slide">{photo}</div>
            ))}
          </div>

          <div className="p-4">
            <h2 className="text-2xl font-bold mb-2">{store.name}</h2>
            <div className="flex items-center mb-4">
              <span className="text-yellow-500 mr-1">â­</span>
              <span className="font-semibold mr-1">{store.rating}</span>
              <span className="text-gray-500">(ë¦¬ë·° {store.reviewCount}ê°œ)</span>
            </div>

            <div className="space-y-2 mb-6">
              <div className="flex items-start">
                <span className="mr-2">ğŸ“</span>
                <span className="text-gray-700">{store.address}</span>
              </div>
              <div className="flex items-start">
                <span className="mr-2">ğŸ•</span>
                <span className="text-gray-700">{store.hours}</span>
              </div>
              <div className="flex items-start">
                <span className="mr-2">ğŸ“</span>
                <span className="text-gray-700">{store.phone}</span>
              </div>
            </div>

            <hr className="my-6" />

            <h3 className="font-bold mb-3">ğŸ›ï¸ ë§¤ì¥ ì„±ê²©</h3>
            <div className="flex flex-wrap gap-2 mb-6">
              {store.storeTypes.map(type => (
                <span key={type} className="px-3 py-1 bg-gray-100 rounded-full text-sm">
                  {storeTypeLabels[type].emoji} {storeTypeLabels[type].label}
                </span>
              ))}
            </div>

            <h3 className="font-bold mb-3">â™»ï¸ ì˜· ì²˜ë¶„í•˜ê¸°</h3>
            <div className="flex flex-wrap gap-2 mb-6">
              {store.disposal.map(d => (
                <span key={d} className="px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm">
                  {disposalLabels[d].emoji} {disposalLabels[d].label}
                </span>
              ))}
            </div>

            <h3 className="font-bold mb-3">ğŸ’¡ ì£¼ìš” ìŠ¤íƒ€ì¼</h3>
            <div className="flex flex-wrap gap-2 mb-6">
              {store.styles.map(style => (
                <span key={style} className="px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm">
                  {styleLabels[style].emoji} {styleLabels[style].label}
                </span>
              ))}
            </div>

            <h3 className="font-bold mb-3">ğŸ¢ í¸ì˜ì‹œì„¤</h3>
            <div className="flex gap-4 mb-6">
              <span>{store.amenities.fitting ? 'âœ…' : 'âŒ'} í”¼íŒ…ë£¸</span>
              <span>{store.amenities.restroom ? 'âœ…' : 'âŒ'} í™”ì¥ì‹¤</span>
              <span>{store.amenities.parking ? 'âœ…' : 'âŒ'} ì£¼ì°¨</span>
            </div>

            <hr className="my-6" />

            <div ref={detailMapRef} style={{ width: '100%', height: '200px', borderRadius: '12px' }} />

            <div className="grid grid-cols-3 gap-2 my-6">
              <button 
                className="py-3 border rounded-lg font-medium"
                onClick={() => window.open(`https://map.kakao.com/link/to/${store.name},${store.lat},${store.lng}`)}
              >
                ğŸ“ ê¸¸ì°¾ê¸°
              </button>
              <button 
                className="py-3 border rounded-lg font-medium"
                onClick={() => window.open(`tel:${store.phone}`)}
              >
                ğŸ“ ì „í™”
              </button>
              <button 
                className="py-3 border rounded-lg font-medium"
                onClick={() => {
                  if (navigator.share) {
                    navigator.share({ title: store.name, url: window.location.href });
                  }
                }}
              >
                ğŸ”— ê³µìœ 
              </button>
            </div>

            <hr className="my-6" />

            <div className="flex justify-between items-center mb-4">
              <h3 className="font-bold">ğŸ’¬ ë¦¬ë·° {store.reviewCount}ê°œ</h3>
              <button className="text-blue-500 text-sm">ì „ì²´ë³´ê¸° &gt;</button>
            </div>

            <div className="space-y-4 mb-8">
              <div className="p-4 bg-gray-50 rounded-lg">
                <div className="flex items-center mb-2">
                  <span className="font-semibold mr-2">ğŸ‘¤ ì‚¬ìš©ìA</span>
                  <span className="text-yellow-500">â­â­â­â­â­</span>
                </div>
                <p className="text-gray-700 mb-1">"ë§¤ì… ê°€ê²© í•©ë¦¬ì ì´ê³  ì¹œì ˆí•´ìš”!"</p>
                <p className="text-gray-400 text-sm">2024.12.20</p>
              </div>

              <div className="p-4 bg-gray-50 rounded-lg">
                <div className="flex items-center mb-2">
                  <span className="font-semibold mr-2">ğŸ‘¤ ì‚¬ìš©ìB</span>
                  <span className="text-yellow-500">â­â­â­â­</span>
                </div>
                <p className="text-gray-700 mb-1">"ë³´ë¬¼ì°¾ëŠ” ì¬ë¯¸ê°€ ìˆì–´ìš”!"</p>
                <p className="text-gray-400 text-sm">2024.12.18</p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    function App() {
      const [isBottomSheetOpen, setIsBottomSheetOpen] = useState(false);
      const [isFilterOpen, setIsFilterOpen] = useState(false);
      const [filters, setFilters] = useState({});
      const [selectedStore, setSelectedStore] = useState(null);

      const filteredStores = sampleStores.filter(store => {
        if (filters.storeTypes?.length && !filters.storeTypes.some(f => store.storeTypes.includes(f))) return false;
        if (filters.disposal?.length && !filters.disposal.some(f => store.disposal.includes(f))) return false;
        if (filters.styles?.length && !filters.styles.some(f => store.styles.includes(f))) return false;
        if (filters.gender?.length && !filters.gender.includes(store.gender)) return false;
        if (filters.amenities?.length && !filters.amenities.every(f => store.amenities[f])) return false;
        return true;
      });

      const activeFilterCount = Object.values(filters).flat().length;

      const handleReset = () => {
        setIsBottomSheetOpen(false);
        setFilters({});
        setSelectedStore(null);
      };

      const mapHeight = isBottomSheetOpen ? 'calc(33vh - 64px)' : 'calc(100vh - 64px)';

      return (
        <>
          <div className="fixed top-0 left-0 right-0 bg-white border-b p-4 flex justify-between items-center z-50">
            <h1 
              className="text-xl font-bold cursor-pointer hover:text-blue-500 transition-colors"
              onClick={handleReset}
            >
              ğŸ—ºï¸ ë¹ˆí‹°ì§€ ë³´ë¬¼ì§€ë„
            </h1>
            <button
              onClick={() => setIsFilterOpen(true)}
              className="relative px-4 py-2 border rounded-lg hover:bg-gray-50"
            >
              ğŸ›ï¸ í•„í„°
              {activeFilterCount > 0 && (
                <span className="absolute -top-1 -right-1 bg-blue-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">
                  {activeFilterCount}
                </span>
              )}
            </button>
          </div>

          <div className="map-container pt-16" style={{ height: isBottomSheetOpen ? '33vh' : '100vh' }}>
            <KakaoMap 
              stores={filteredStores}
              onMarkerClick={(store) => {
                setSelectedStore(store);
                setIsBottomSheetOpen(false);
              }}
              height={mapHeight}
            />
          </div>

          <div className={`bottom-sheet ${isBottomSheetOpen ? 'open' : 'closed'}`}>
            <div
              className="cursor-pointer"
              onClick={() => setIsBottomSheetOpen(!isBottomSheetOpen)}
            >
              <div className="handle"></div>
              {!isBottomSheetOpen && (
                <div className="text-center pb-4 font-semibold">
                  ëª©ë¡ ì—´ê¸° ({filteredStores.length}ê°œ)
                </div>
              )}
            </div>

            {isBottomSheetOpen && (
              <div className="overflow-y-auto" style={{ maxHeight: 'calc(70vh - 60px)' }}>
                <div className="text-center py-2 font-semibold border-b">
                  ë§¤ì¥ {filteredStores.length}ê°œ
                </div>
                
                {filteredStores.map(store => (
                  <div
                    key={store.id}
                    className="card"
                    onClick={() => setSelectedStore(store)}
                  >
                    <h3 className="font-bold text-lg mb-2">ğŸª {store.name}</h3>
                    <p className="text-gray-600 text-sm mb-2">ğŸ“ {store.address} Â· {store.distance}</p>
                    <div className="flex flex-wrap gap-1 mb-2">
                      {store.storeTypes.map(type => (
                        <span key={type} className="text-xs px-2 py-1 bg-gray-100 rounded">
                          {storeTypeLabels[type].emoji} {storeTypeLabels[type].label}
                        </span>
                      ))}
                      {store.disposal.slice(0, 2).map(d => (
                        <span key={d} className="text-xs px-2 py-1 bg-green-50 text-green-700 rounded">
                          {disposalLabels[d].emoji} {disposalLabels[d].label}
                        </span>
                      ))}
                    </div>
                    <div className="flex items-center">
                      <span className="text-yellow-500 mr-1">â­</span>
                      <span className="font-semibold mr-1">{store.rating}</span>
                      <span className="text-gray-500 text-sm">({store.reviewCount})</span>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>

          <FilterModal
            isOpen={isFilterOpen}
            onClose={() => setIsFilterOpen(false)}
            filters={filters}
            setFilters={setFilters}
          />

          {selectedStore && (
            <DetailPage
              store={selectedStore}
              onClose={() => setSelectedStore(null)}
            />
          )}
        </>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
